<!doctype html>
<html lang="ja">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Translation DB Tool</title>
<link rel="stylesheet" href="app.css">
<body>
<header>
  <div>
    <h1>Translation DB Tool</h1>
    <small>超シンプル・ローカル辞書照会 (CSV &amp; XML / SQLite / FTS5)</small>
  </div>
  <div class="row">
    <button id="themeBtn" title="テーマ切替">🌓 テーマ</button>
    <a href="/health" target="_blank"><button title="生存確認">/health</button></a>
  </div>
</header>

<main class="grid">
  <nav aria-label="モード切替">
    <button class="tab" id="tab-search" aria-selected="true">検索（一覧）</button>
    <button class="tab" id="tab-query" aria-selected="false">照会（LLM補助）</button>
  </nav>

  <!-- 検索タブ -->
  <section id="panel-search" class="card" role="tabpanel" aria-labelledby="tab-search">
    <div class="row">
      <input id="q" type="text" placeholder="例: saving throw" style="min-width:280px">
      <label>size <input id="size" type="number" value="20" min="1" max="200" style="width:80px"></label>
      <button id="btnSearch">検索</button>
      <small class="muted" id="searchStatus"></small>
      <span class="right"></span>
      <button id="copyTable">表コピー（TSV）</button>
    </div>
    <div id="searchTableWrap" style="overflow:auto;max-height:60vh">
      <table id="searchTable" hidden>
        <thead><tr><th>ID</th><th>EN</th><th>JA</th><th>score</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </section>

  <!-- 照会タブ -->
  <section id="panel-query" class="card" role="tabpanel" aria-labelledby="tab-query" hidden>
    <div class="grid cols-2">
      <div>
        <div class="row">
          <label>Top-K <input id="topk" type="number" value="3" min="1" max="5" style="width:80px"></label>
          <button id="btnRun">照会する</button>
          <small class="muted" id="queryStatus"></small>
        </div>
        <label class="muted">改行区切りで語/フレーズを貼る</label>
        <textarea id="terms" placeholder="saving throw&#10;ability check&#10;Mind Sliver"></textarea>
        <div class="row">
          <button id="copyJSONL">JSONLコピー</button>
          <button id="copyTSV">TSVコピー</button>
          <small class="muted">（<kbd>EN</kbd>, <kbd>JA</kbd> を LLM へ最小形式で渡す用）</small>
        </div>
      </div>
      <div>
        <div id="queryTableWrap" style="overflow:auto;max-height:60vh">
          <table id="queryTable" hidden>
            <thead>
              <tr><th>Term</th><th>候補1</th><th>候補2</th><th>候補3</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </section>
</main>

<footer>
  <div>Local DB: <code class="mono">data/app.sqlite</code> ／ API: <code class="mono">/search</code>, <code class="mono">/query</code></div>
  <div>ダークテーマは右上の 🌓 で切替（保存されます）</div>
</footer>

<script defer src="app.js"></script>
</body>
</html>
